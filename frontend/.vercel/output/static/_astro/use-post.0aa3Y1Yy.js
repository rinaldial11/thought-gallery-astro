import{a as h,u as f,s as y,t as d}from"./user.jfv1eZqe.js";import{r as a}from"./index.Dy7WD_uu.js";const p=async(t="published",e)=>{try{if(t==="draft")return(await h.get("/items/posts?fields=*,author.first_name,author.last_name,author.email",{params:{filter:{status:{_eq:"draft"}}},headers:{Authorization:`Bearer ${e}`}})).data?.data}catch(s){throw console.log(s),s}},m=async(t="published")=>{try{if(t==="published")return(await h.get("/items/posts?fields=*,author.first_name,author.last_name,author.email",{params:{filter:{status:{_eq:"published"}}}})).data?.data}catch(e){throw console.log(e),e}},w=async(t,e)=>{try{return(await h.get(`/items/posts/${t}`,{headers:{Authorization:`Bearer ${e}`}})).data?.data}catch(s){throw console.log(s),s}},P=async(t,e)=>{try{await h.post("/items/posts",t,{headers:{Authorization:`Bearer ${e}`}})}catch(s){throw console.log(s),s}},g=async(t,e,s)=>{try{await h.patch(`/items/posts/${s}`,t,{headers:{Authorization:`Bearer ${e}`}})}catch(o){throw console.log(o),o}},_=(t="published")=>{const[e]=f(d),[s,o]=a.useState([]),[r,i]=a.useState(!0),[u,n]=a.useState(null);return a.useEffect(()=>{if(!e?.access_token)return;(async()=>{try{const c=await p(t,e.access_token??"");o(c??[])}catch(c){n(c)}finally{i(!1)}})()},[t,e]),{posts:s,loading:r,error:u}},S=(t="published")=>{const[e,s]=a.useState([]),[o,r]=a.useState(!0),[i,u]=a.useState(null);return a.useEffect(()=>{(async()=>{try{const l=await m(t);s(l??[])}catch(l){u(l)}finally{r(!1)}})()},[t]),{publicPosts:e,isLoading:o,error:i}},E=t=>{const[e,s]=a.useState(null),[o,r]=a.useState(!0),[i,u]=a.useState(null),[n]=f(d);return a.useEffect(()=>{if(!t||!n.access_token)return;(async()=>{try{const c=await w(t,n.access_token??"");s(c??null)}catch(c){u(c)}finally{r(!1)}})()},[t,n.access_token]),{postById:e,isLoading:o,error:i}},B=()=>{const[t]=f(d);return{submitPost:async(s,o)=>{try{if(!t.access_token)throw y("Session Expired","No access token available","error"),new Error("No access token available");o==="new"?await P(s,t.access_token):await g(s,t.access_token,o)}catch(r){throw console.log(r),r}}}};export{S as a,E as b,B as c,_ as u};
